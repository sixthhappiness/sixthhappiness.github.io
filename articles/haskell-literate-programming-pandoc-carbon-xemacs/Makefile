# Without before.xml and after.xml, file generated by pandoc is not
# well-formed XML.

PANDOC = pandoc --wrap=none -f markdown+smart -t markdown-smart --highlight-style=kate

all: index.html Make_file.txt

index.html: index.xml contents.xml contents.lhs before.xml after.xml ../../articles.xml
	xsltproc index.xml > index.html

contents.xml: contents.lhs
	$(PANDOC) -f markdown+lhs -t html+lhs contents.lhs > temp.xml
	cat before.xml temp.xml after.xml > contents.xml
	rm -f temp.xml

# Since Makefile is not copied to website.
Make_file.txt: Makefile
	cp Makefile Make_file.txt

clean:
	rm -rf *~ contents.xml index.html Make_file.txt temp.xml
